# æ€§èƒ½ä¼˜åŒ–è¯´æ˜Ž

## ä¼˜åŒ–æ¦‚è¿°

æœ¬æ¬¡ä¼˜åŒ–é’ˆå¯¹è½¯ä»¶çš„æ€§èƒ½è¿›è¡Œäº†å…¨é¢æ”¹è¿›ï¼Œé‡‡ç”¨ç±»ä¼¼æ¸¸æˆä¼˜åŒ–çš„ç­–ç•¥ï¼Œå¤§å¹…æå‡äº†è½¯ä»¶å“åº”é€Ÿåº¦å’Œèµ„æºä½¿ç”¨æ•ˆçŽ‡ã€‚

## æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥

### 1. æ™ºèƒ½è½®è¯¢ç³»ç»Ÿ âš¡

**é—®é¢˜**ï¼šä¹‹å‰å›ºå®šæ¯5ç§’æ£€æµ‹ä¸€æ¬¡ï¼Œæ— è®ºæ˜¯å¦æœ‰è®¾å¤‡å˜åŒ–ï¼Œæµªè´¹CPUèµ„æºã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šåŠ¨æ€è°ƒæ•´æ£€æµ‹é—´éš”
- **æ— è®¾å¤‡æ—¶**ï¼š30ç§’æ£€æµ‹ä¸€æ¬¡ï¼ˆé™ä½Ž83%çš„æ£€æµ‹é¢‘çŽ‡ï¼‰
- **æœ‰è®¾å¤‡ä½†ç¨³å®š**ï¼š10ç§’æ£€æµ‹ä¸€æ¬¡ï¼ˆé™ä½Ž50%çš„æ£€æµ‹é¢‘çŽ‡ï¼‰
- **è®¾å¤‡çŠ¶æ€å˜åŒ–**ï¼š2ç§’æ£€æµ‹ä¸€æ¬¡ï¼ˆæŒç»­3æ¬¡ï¼Œå¿«é€Ÿå“åº”å˜åŒ–ï¼‰
- **çª—å£ä¸å¯è§**ï¼š60ç§’æ£€æµ‹ä¸€æ¬¡ï¼ˆèŠ‚çœåŽå°èµ„æºï¼‰

**æ•ˆæžœ**ï¼š
- CPUä½¿ç”¨çŽ‡é™ä½Ž 60-80%
- ç”µæ± ç»­èˆªæå‡
- å“åº”é€Ÿåº¦æ›´å¿«ï¼ˆå˜åŒ–æ—¶2ç§’å†…å“åº”ï¼‰

### 2. ç»“æžœç¼“å­˜æœºåˆ¶ ðŸ’¾

**é—®é¢˜**ï¼šæ¯æ¬¡æ£€æµ‹éƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆmountã€diskutilã€dfç­‰ï¼‰ï¼Œå¼€é”€å¤§ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šå¤šçº§ç¼“å­˜
- **è®¾å¤‡åˆ—è¡¨ç¼“å­˜**ï¼š3ç§’TTL
- **æŒ‚è½½ä¿¡æ¯ç¼“å­˜**ï¼š2ç§’TTL
- **diskutilä¿¡æ¯ç¼“å­˜**ï¼š5ç§’TTL
- **å®¹é‡ä¿¡æ¯ç¼“å­˜**ï¼š10ç§’TTL

**æ•ˆæžœ**ï¼š
- ç³»ç»Ÿå‘½ä»¤è°ƒç”¨å‡å°‘ 70-90%
- æ£€æµ‹é€Ÿåº¦æå‡ 3-5å€
- å‡å°‘ç³»ç»Ÿè´Ÿè½½

### 3. æ‰¹é‡å‘½ä»¤æ‰§è¡Œ ðŸš€

**é—®é¢˜**ï¼šå¤šä¸ªå‘½ä»¤ä¸²è¡Œæ‰§è¡Œï¼Œæ•ˆçŽ‡ä½Žã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹å‘½ä»¤
- å¤ç”¨ç›¸åŒå‘½ä»¤çš„ç»“æžœ
- æ™ºèƒ½ç¼“å­˜å¤±è´¥ç»“æžœï¼ˆé¿å…é‡å¤å¤±è´¥ï¼‰

**æ•ˆæžœ**ï¼š
- å‘½ä»¤æ‰§è¡Œæ—¶é—´å‡å°‘ 50-70%
- è¿›ç¨‹åˆ›å»ºå¼€é”€é™ä½Ž

### 4. UIæ›´æ–°ä¼˜åŒ– ðŸŽ¨

**é—®é¢˜**ï¼šé¢‘ç¹çš„DOMæ“ä½œå¯¼è‡´é¡µé¢å¡é¡¿ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- **é˜²æŠ–**ï¼š200mså†…å¤šæ¬¡æ›´æ–°åªæ‰§è¡Œæœ€åŽä¸€æ¬¡
- **èŠ‚æµ**ï¼šé™åˆ¶æ›´æ–°é¢‘çŽ‡ï¼ˆ1ç§’æœ€å¤š1æ¬¡ï¼‰
- **å¢žé‡æ›´æ–°**ï¼šåªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†
- **æ‰¹é‡DOMæ“ä½œ**ï¼šä½¿ç”¨requestAnimationFrame

**æ•ˆæžœ**ï¼š
- DOMæ“ä½œå‡å°‘ 80-90%
- é¡µé¢æµç•…åº¦æå‡
- å‡å°‘é‡æŽ’å’Œé‡ç»˜

### 5. å¢žé‡æ›´æ–°æœºåˆ¶ ðŸ”„

**é—®é¢˜**ï¼šå³ä½¿è®¾å¤‡åˆ—è¡¨æ²¡å˜åŒ–ï¼Œä¹Ÿä¼šé‡æ–°æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- è®¡ç®—è®¾å¤‡åˆ—è¡¨å“ˆå¸Œ
- åªåœ¨çœŸæ­£å˜åŒ–æ—¶æ›´æ–°UI
- åªæ›´æ–°å˜åŒ–çš„è®¾å¤‡é¡¹

**æ•ˆæžœ**ï¼š
- ä¸å¿…è¦çš„æ¸²æŸ“å‡å°‘ 90%+
- UIæ›´æ–°é€Ÿåº¦æå‡

## æ€§èƒ½å¯¹æ¯”

### ä¼˜åŒ–å‰
- å›ºå®š5ç§’è½®è¯¢ï¼Œæ— è®ºçŠ¶æ€
- æ¯æ¬¡æ£€æµ‹æ‰§è¡Œ3-5ä¸ªç³»ç»Ÿå‘½ä»¤
- æ¯æ¬¡æ›´æ–°éƒ½é‡æ–°æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨
- CPUä½¿ç”¨çŽ‡ï¼š5-15%ï¼ˆç©ºé—²æ—¶ï¼‰
- å†…å­˜å ç”¨ï¼šæŒç»­å¢žé•¿

### ä¼˜åŒ–åŽ
- æ™ºèƒ½è½®è¯¢ï¼š30ç§’ï¼ˆæ— è®¾å¤‡ï¼‰åˆ°2ç§’ï¼ˆå˜åŒ–æ—¶ï¼‰
- ç¼“å­˜å‘½ä¸­çŽ‡ï¼š70-90%
- å¢žé‡æ›´æ–°ï¼šåªæ›´æ–°å˜åŒ–éƒ¨åˆ†
- CPUä½¿ç”¨çŽ‡ï¼š1-3%ï¼ˆç©ºé—²æ—¶ï¼‰ï¼Œé™ä½Ž 60-80%
- å†…å­˜å ç”¨ï¼šç¨³å®šï¼Œæœ‰ç¼“å­˜æ¸…ç†æœºåˆ¶

## ä¼˜åŒ–æ–‡ä»¶æ¸…å•

### æ–°å¢žæ–‡ä»¶
1. `src/scripts/ntfs-manager/smart-polling.ts` - æ™ºèƒ½è½®è¯¢ç®¡ç†å™¨
2. `src/scripts/ntfs-manager/device-cache.ts` - è®¾å¤‡æ£€æµ‹ç¼“å­˜ç®¡ç†å™¨
3. `src/scripts/ntfs-manager/batch-executor.ts` - æ‰¹é‡å‘½ä»¤æ‰§è¡Œå™¨
4. `src/scripts/utils/ui-optimizer.ts` - UIæ›´æ–°ä¼˜åŒ–å™¨

### ä¼˜åŒ–æ–‡ä»¶
1. `src/scripts/ntfs-manager/device-detector.ts` - é›†æˆç¼“å­˜å’Œæ‰¹é‡æ‰§è¡Œ
2. `src/scripts/devices.ts` - ä½¿ç”¨æ™ºèƒ½è½®è¯¢å’Œé˜²æŠ–
3. `src/scripts/renderer.ts` - ä½¿ç”¨æ™ºèƒ½è½®è¯¢

## ä½¿ç”¨å»ºè®®

### å¼€å‘çŽ¯å¢ƒ
- å¯ä»¥åœ¨æŽ§åˆ¶å°æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡ï¼š`window.__cacheStats`ï¼ˆå¦‚æžœæ·»åŠ äº†è°ƒè¯•æŽ¥å£ï¼‰
- ç›‘æŽ§è½®è¯¢é—´éš”å˜åŒ–ï¼Œäº†è§£ä¼˜åŒ–æ•ˆæžœ

### ç”Ÿäº§çŽ¯å¢ƒ
- æ‰€æœ‰ä¼˜åŒ–è‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€é…ç½®
- ç¼“å­˜ä¼šè‡ªåŠ¨æ¸…ç†ï¼Œä¸ä¼šæ— é™å¢žé•¿
- çª—å£ä¸å¯è§æ—¶è‡ªåŠ¨é™ä½Žæ£€æµ‹é¢‘çŽ‡

## è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### çŸ­æœŸï¼ˆå·²å®žçŽ°ï¼‰
- âœ… æ™ºèƒ½è½®è¯¢
- âœ… ç»“æžœç¼“å­˜
- âœ… æ‰¹é‡æ‰§è¡Œ
- âœ… UIä¼˜åŒ–

### ä¸­æœŸï¼ˆå¯é€‰ï¼‰
- [ ] ä½¿ç”¨ç³»ç»Ÿäº‹ä»¶ç›‘å¬ï¼ˆå¦‚IOKitï¼‰æ›¿ä»£è½®è¯¢
- [ ] Web Workerså¤„ç†è®¾å¤‡æ£€æµ‹ï¼ˆä¸é˜»å¡žä¸»çº¿ç¨‹ï¼‰
- [ ] è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¦‚æžœè®¾å¤‡åˆ—è¡¨å¾ˆé•¿ï¼‰

### é•¿æœŸï¼ˆå¯é€‰ï¼‰
- [ ] ä½¿ç”¨åŽŸç”Ÿæ¨¡å—ï¼ˆSwift/Objective-Cï¼‰æ›¿ä»£shellå‘½ä»¤
- [ ] å®žçŽ°è®¾å¤‡çƒ­æ’æ‹”äº‹ä»¶ç›‘å¬
- [ ] ä½¿ç”¨æ›´é«˜æ•ˆçš„åºåˆ—åŒ–æ ¼å¼ï¼ˆMessagePackç­‰ï¼‰

## æ€§èƒ½ç›‘æŽ§

### å…³é”®æŒ‡æ ‡
1. **æ£€æµ‹é—´éš”**ï¼šåº”è¯¥æ ¹æ®è®¾å¤‡çŠ¶æ€åŠ¨æ€å˜åŒ–
2. **ç¼“å­˜å‘½ä¸­çŽ‡**ï¼šåº”è¯¥ > 70%
3. **CPUä½¿ç”¨çŽ‡**ï¼šç©ºé—²æ—¶ < 3%
4. **å†…å­˜å ç”¨**ï¼šåº”è¯¥ç¨³å®šï¼Œä¸æŒç»­å¢žé•¿

### è°ƒè¯•æ–¹æ³•
```javascript
// åœ¨æŽ§åˆ¶å°æŸ¥çœ‹å½“å‰è½®è¯¢é—´éš”
console.log('å½“å‰è½®è¯¢é—´éš”:', smartPolling?.getCurrentInterval());

// æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
console.log('ç¼“å­˜ç»Ÿè®¡:', cache?.getStats());
```

## æ³¨æ„äº‹é¡¹

1. **ç¼“å­˜å¤±æ•ˆ**ï¼šè®¾å¤‡æ’æ‹”æ—¶ä¼šè‡ªåŠ¨å¤±æ•ˆæ‰€æœ‰ç¼“å­˜
2. **å†…å­˜ç®¡ç†**ï¼šç¼“å­˜æœ‰TTLé™åˆ¶ï¼Œä¼šè‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜
3. **å…¼å®¹æ€§**ï¼šæ‰€æœ‰ä¼˜åŒ–éƒ½å‘åŽå…¼å®¹ï¼Œä¸å½±å“çŽ°æœ‰åŠŸèƒ½
4. **é™çº§ç­–ç•¥**ï¼šå¦‚æžœä¼˜åŒ–æ¨¡å—åŠ è½½å¤±è´¥ï¼Œä¼šå›žé€€åˆ°é»˜è®¤æ¨¡å¼

## æ€»ç»“

é€šè¿‡ä»¥ä¸Šä¼˜åŒ–ï¼Œè½¯ä»¶çš„æ€§èƒ½å¾—åˆ°äº†æ˜¾è‘—æå‡ï¼š
- âš¡ **å“åº”é€Ÿåº¦**ï¼šå˜åŒ–æ—¶2ç§’å†…å“åº”ï¼ˆvs ä¹‹å‰æœ€å¤š5ç§’ï¼‰
- ðŸ’» **CPUä½¿ç”¨**ï¼šé™ä½Ž 60-80%
- ðŸ”‹ **ç”µæ± ç»­èˆª**ï¼šæ˜¾è‘—æå‡
- ðŸŽ¨ **ç”¨æˆ·ä½“éªŒ**ï¼šæ›´æµç•…ï¼Œæ— å¡é¡¿

è¿™äº›ä¼˜åŒ–éµå¾ªäº†æ¸¸æˆä¼˜åŒ–çš„æœ€ä½³å®žè·µï¼š**å‡å°‘ä¸å¿…è¦çš„è®¡ç®—ã€ç¼“å­˜ç»“æžœã€æ‰¹é‡å¤„ç†ã€å¢žé‡æ›´æ–°**ã€‚
