## 免責聲明

使用本工具掛載和修改 NTFS 設備存在資料遺失的風險。建議在使用前備份重要資料。本工具按"現狀"提供，不提供任何明示或暗示的擔保。使用本工具造成的任何資料損失，開發者不承擔責任。

## 系統要求

使用本工具需要以下系統依賴：

1. **Swift (Xcode Command Line Tools)** - Apple 的開發工具
2. **Homebrew** - macOS 的套件管理器
3. **MacFUSE** - 檔案系統使用者空間框架
4. **ntfs-3g** - NTFS 檔案系統驅動

### 安裝系統依賴

首次使用前，請先檢查系統依賴是否已安裝。在"系統依賴"標籤頁中點擊"檢查依賴"按鈕，系統會自動檢測所需依賴的安裝狀態。

如果檢測到缺失的依賴，請按照以下步驟手動安裝：

#### 1. 安裝 Xcode Command Line Tools

在終端執行以下命令：

```bash
xcode-select --install
```

執行後會彈出安裝視窗，按照提示完成安裝。安裝過程可能需要幾分鐘到幾十分鐘，請耐心等待。

#### 2. 安裝 Homebrew

在終端執行以下命令：

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

按照提示完成安裝。如果網路較慢，可以使用國內鏡像源：

```bash
/bin/bash -c "$(curl -fsSL https://gitee.com/ineo6/homebrew-install/raw/master/install.sh)"
```

#### 3. 安裝 MacFUSE

在終端執行以下命令：

```bash
brew install --cask macfuse
```

#### 4. 安裝 ntfs-3g

在終端執行以下命令：

```bash
brew tap gromgit/homebrew-fuse
brew install ntfs-3g-mac
```

**注意**：安裝順序很重要，請按照 1 → 2 → 3 → 4 的順序依次安裝。

## 使用步驟

### 檢查系統依賴

在"系統依賴"標籤頁中點擊"檢查依賴"按鈕，系統會自動檢測所需依賴的安裝狀態。如果檢測到缺失的依賴，會顯示詳細的安裝指引，包括安裝命令和說明。

### 管理 NTFS 設備

插入 NTFS 格式的移動儲存設備後，在"NTFS 設備"標籤頁中可以查看所有已連接的設備。

設備狀態分為兩種：

- **只讀** - 設備只能讀取，無法寫入。這是 macOS 對 NTFS 設備的預設處理方式。
- **讀寫** - 設備已掛載為讀寫模式，可以正常讀寫檔案。

### 掛載設備為讀寫模式

對於只讀狀態的設備，可以點擊"配置為可讀寫"按鈕將其掛載為讀寫模式。此操作需要管理員權限，系統會彈出密碼輸入對話框。

**注意事項：**

- 掛載操作需要管理員權限，請準備好您的系統密碼
- 如果掛載失敗，可能的原因包括：
  - 設備檔案系統處於髒狀態（如果該 NTFS 設備之前在 Windows 電腦上使用過，且 Windows 啟用了快速啟動功能，請將設備插回 Windows 電腦並完全關閉後再試）
  - 設備被其他程式佔用
  - 系統權限問題
- 掛載後請安全彈出設備，避免資料遺失

### 卸載設備

對於已掛載的設備，可以點擊"卸載"按鈕將其卸載。卸載操作需要管理員權限。

**卸載的特點：**
- 從檔案系統中移除設備
- 設備仍然實體連接在電腦上
- 系統可能會自動重新掛載設備（例如重新插入或系統自動掛載）
- 設備會保留在列表中，標記為"已卸載"狀態
- 可以重新掛載使用

**適用場景：**
- 臨時斷開設備存取，但設備仍連接在電腦上
- 需要重新配置設備掛載方式
- 設備出現問題時，先卸載再重新掛載

### 推出設備

對於已掛載的設備，可以點擊"推出"按鈕將其完全斷開。推出操作不需要管理員權限。

**推出的特點：**
- 完全斷開設備，從系統中移除
- 設備會從列表中消失
- 系統不會自動重新掛載設備
- 需要重新插入設備才能再次使用
- 提示可以安全拔出設備

**適用場景：**
- 準備拔出設備前，確保資料已完全寫入
- 需要完全斷開設備連接
- 設備不再需要使用時
- 類似 macOS Finder 中的"推出"功能

**卸載 vs 推出的區別：**

| 特性 | 卸載 | 推出 |
|------|------|------|
| 需要管理員權限 | ✅ 是 | ❌ 否 |
| 設備實體連接 | ✅ 保持連接 | ✅ 保持連接 |
| 系統自動重新掛載 | ⚠️ 可能會 | ❌ 不會 |
| 設備在列表中 | ✅ 保留（標記為已卸載） | ❌ 移除 |
| 可以重新掛載 | ✅ 可以 | ❌ 需要重新插入 |
| 適用場景 | 臨時斷開、重新配置 | 準備拔出、完全斷開 |

## 常見問題

### 為什麼我的設備顯示為只讀？

這是 macOS 的預設行為。macOS 預設以只讀模式掛載 NTFS 設備。使用本工具可以將設備掛載為讀寫模式。

### 掛載失敗怎麼辦？

如果掛載操作失敗或超時，請檢查以下幾點：

- **系統依賴**：確保已安裝所有系統依賴（Xcode Command Line Tools、Homebrew、MacFUSE、ntfs-3g）
- **管理員權限**：確保輸入的管理員密碼正確
- **檔案系統狀態**：如果該 NTFS 設備之前在 Windows 電腦上使用過，且 Windows 啟用了快速啟動功能，檔案系統可能處於髒狀態。請將設備插回 Windows 電腦並完全關閉（而非休眠），然後重新嘗試掛載
- **設備佔用**：檢查設備是否有其他程式正在使用，關閉相關程式後重試
- **操作超時**：如果操作超時，應用程式會自動取消操作以防止卡死。請檢查上述原因後重試

### 安裝依賴失敗怎麼辦？

如果安裝過程中遇到問題，請檢查以下幾點：

- **網路連接**：確保網路連接正常，安裝過程需要下載檔案
- **磁碟空間**：確保有足夠的磁碟空間（Xcode Command Line Tools 需要幾個 GB 的空間）
- **系統權限**：確保有管理員權限，某些安裝需要輸入密碼
- **安裝順序**：請按照正確的順序安裝依賴（Xcode → Homebrew → MacFUSE → ntfs-3g）

**常見問題：**

1. **Xcode Command Line Tools 安裝失敗**
   - 檢查網路連接
   - 嘗試從 Apple 開發者網站手動下載安裝包

2. **Homebrew 安裝慢或失敗**
   - 使用國內鏡像源（見上方安裝步驟）
   - 檢查網路代理設定

3. **MacFUSE 或 ntfs-3g 安裝失敗**
   - 確保已先安裝 Homebrew
   - 執行 `brew update` 更新 Homebrew
   - 檢查是否有權限問題

如果仍然無法解決，請參考各依賴的官方文件或尋求技術支援。

### 卸載設備後無法存取？

卸載後設備會從系統中移除。如果需要重新存取，請重新插入設備或使用系統自帶的掛載功能。

## 操作日誌

在"操作日誌"標籤頁中可以查看所有操作的記錄，包括：

- 依賴檢查結果
- 設備檢測狀態
- 掛載/卸載操作結果
- 錯誤資訊和警告

**啟用操作日誌：**

操作日誌預設關閉，需要手動啟用。在"操作日誌"標籤頁中勾選"啟用操作日誌"核取方塊即可開啟。啟用後，應用會記錄所有操作日誌。關閉後，將不再記錄新的日誌，但已記錄的日誌仍會保留。

**日誌儲存：**

日誌以 JSON 格式儲存在檔案系統中，儲存位置為：

```
~/Library/Application Support/Nigate/logs.json
```

日誌檔案採用格式化的 JSON 格式，可以直接用文字編輯器開啟查看。卸載應用時，日誌檔案不會自動刪除，便於後續查看或備份。

**日誌限制：**

為了確保應用效能和穩定性，日誌系統設定了以下限制：

- **保留期限**：日誌預設最長保存 30 天，超過 30 天的日誌會自動清理
- **記錄數量限制**：最多保留 500 條日誌記錄，超過限制時會自動刪除最舊的記錄，保留最新的 500 條
- **檔案大小限制**：日誌檔案最大為 500KB，超過限制時會自動刪除舊記錄以保持檔案大小在限制內
- **顯示數量限制**：介面中最多顯示 300 條日誌（最新的 300 條），以提高渲染效能

**日誌管理：**

- **清空日誌**：點擊"清空"按鈕可以清除所有日誌記錄
- **匯出日誌**：點擊"匯出"按鈕可以將日誌匯出為文字檔案，便於備份或分享

## 更多疑難解答

如果您遇到其他問題（如"檔案損壞"提示、設備 busy 錯誤、驅動衝突等），請參考我們的 [疑難解答中心](https://github.com/hoochanlon/Free-NTFS-for-Mac/issues/9)，其中包含了詳細的故障排除步驟和解決方案。
