// macOS 风格 NTFS 设备标签页样式
@import 'variables'

// Devices页面独立窗口样式（浏览器窗口）
.devices-page
  display flex
  flex-direction column
  height 100vh
  overflow hidden
  background var(--bg-primary)
  transition background-color 0.25s cubic-bezier(0.4, 0, 0.2, 1)

.devices-header
  display flex
  align-items center
  height 28px
  flex-shrink 0
  -webkit-app-region drag
  position relative

.devices-traffic-lights
  width 78px
  height 100%
  -webkit-app-region no-drag
  flex-shrink 0

.devices-content
  flex 1
  overflow hidden
  display flex
  flex-direction column
  min-height 0

  .section
    flex 1
    margin 0
    border none
    border-radius 0
    padding 8px
    overflow-y auto
    overflow-x hidden
    box-shadow none
    background var(--bg-primary)
    transition background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1)
    display flex
    flex-direction column
    min-height 0

    // 滚动条样式
    &::-webkit-scrollbar
      width 6px

    &::-webkit-scrollbar-track
      background transparent

    &::-webkit-scrollbar-thumb
      background var(--border)
      border-radius 3px

      &:hover
        background var(--accent)

    // 托盘窗口中的 section 更紧凑
    .tray-window &
      padding 4px

      // 托盘窗口中的滚动条更细
      &::-webkit-scrollbar
        width 4px

  .devices-section-header
    display flex
    justify-content flex-end
    align-items center
    margin-bottom 8px
    flex-shrink 0
    gap 4px
    padding 0 10px

    h2
      display none

    // 托盘窗口中的头部区域样式
    .tray-window &
      margin-bottom 4px
      padding 4px 10px

  .devices-header-actions
    display flex
    flex-direction column
    gap 6px
    align-items flex-end
    width 100%

    .devices-action-buttons-row
      display flex
      gap 3px
      align-items center
      flex-wrap wrap
      justify-content flex-end
      width 100%

    .auto-mount-checkbox
      display flex
      align-items center
      gap 6px
      font-size 11px
      color var(--text-primary)
      cursor pointer
      user-select none
      padding 4px 8px
      border-radius 3px
      transition background-color 0.15s ease
      white-space nowrap

      &:hover
        background var(--bg-tertiary)

      input[type="checkbox"]
        width 14px
        height 14px
        cursor pointer
        accent-color var(--accent)

      span
        font-weight 500
        letter-spacing -0.01em

    .devices-action-buttons
      display flex
      gap 3px
      align-items center
      flex-shrink 0

    .btn
      padding 5px 12px
      font-size 10px
      white-space nowrap
      min-height 24px
      line-height 1.3

      .btn-icon
        width 11px
        height 11px
        display block
        margin 0
        padding 0

    #autoMountBtn,
    #showMainWindowBtn,
    #refreshDevicesBtn
      padding 5px 10px
      min-width auto

    #autoMountBtn.active
      background var(--accent)
      color var(--bg-primary)

      .btn-icon
        filter brightness(0) invert(1)

  .devices-list
    gap 12px
    padding 12px

    // 托盘窗口中的列表更紧凑
    .tray-window &
      gap 4px
      padding 8px

  .device-item
    padding 0
    margin-bottom 12px
    transition all 0.15s cubic-bezier(0.4, 0, 0.2, 1)

    // 托盘窗口中的设备项更紧凑
    .tray-window &
      margin-bottom 2px

  .device-card
    display flex
    align-items flex-start
    padding 12px 16px
    background var(--bg-secondary)
    border 1px solid var(--border)
    border-radius 6px
    transition all 0.2s ease
    cursor pointer

    &:hover
      background var(--bg-hover)
      border-color var(--accent)
      box-shadow 0 2px 8px rgba(0, 0, 0, 0.1)

  // 托盘窗口专用样式（类似 Windows 磁盘显示）
  .device-card-tray
    display flex
    align-items center
    padding 8px 10px
    background transparent
    border none
    border-radius 0
    transition all 0.2s ease
    margin-bottom 0
    width 100%

    &:hover
      background var(--bg-hover)
      border-radius 4px

  .device-icon-large
    margin-right 16px
    flex-shrink 0
    width 48px
    height 48px
    display flex
    align-items center
    justify-content center

    // 托盘窗口中的图标更小
    .device-card-tray &
      width 32px
      height 32px
      margin-right 12px

  .device-icon-svg
    width 48px
    height 48px
    object-fit contain
    flex-shrink 0
    display block
    // 确保 SVG 颜色可以随主题变化
    filter none

    // 托盘窗口中的图标更小
    .device-card-tray &
      width 32px
      height 32px

  .device-card-content
    flex 1
    min-width 0

  .device-name-large
    font-size 14px
    font-weight 600
    color var(--text-primary)
    margin-bottom 8px
    line-height 1.4

    // 托盘窗口中的名称样式
    .device-card-tray &
      font-size 12px
      font-weight 500
      margin-bottom 3px
      line-height 1.2
      color var(--text-primary)

  .device-capacity-info
    font-size 12px
    color var(--text-secondary)
    margin-bottom 6px
    line-height 1.5

  .capacity-available
    color var(--text-primary)
    font-weight 500

  .capacity-separator
    color var(--text-secondary)

  .capacity-total
    color var(--text-secondary)

  // Windows 风格的容量信息显示
  .device-capacity-info-windows
    font-size 10px
    color var(--text-secondary)
    margin-bottom 3px
    line-height 1.3

  .capacity-text-windows
    color var(--text-secondary)
    font-weight 400
    letter-spacing -0.01em

  .capacity-bar-windows
    width 100%
    height 16px
    background-color #e1e1e1
    border 1px solid #c0c0c0
    border-radius 2px
    overflow hidden
    position relative
    margin-top 4px
    box-sizing border-box

    // 托盘窗口中的容量条样式
    .device-card-tray &
      height 14px
      margin-top 3px
      background-color #f0f0f0
      border-color #d0d0d0

  .capacity-bar-fill-windows
    height 100%
    background-color #0078d4
    border-radius 1px
    transition width 0.3s ease-out
    position absolute
    left 0
    top 0
    min-width 0
    display block
    width 0

  // 根据使用率调整颜色（剩余空间越小，颜色越危险）
  // 使用率 >= 90%（剩余空间 <= 10%）：红色
  // 使用率 >= 80%（剩余空间 <= 20%）：黄色
  // 使用率 < 80%（剩余空间 > 20%）：蓝色（默认）
  .device-item[data-capacity-percent]
    // 90%及以上：红色（优先级最高，放在前面）
    &[data-capacity-percent="100"] .capacity-bar-fill-windows,
    &[data-capacity-percent^="9"] .capacity-bar-fill-windows
      background-color #d13438

    // 80-89%：黄色（优先级中等）
    &[data-capacity-percent^="8"] .capacity-bar-fill-windows
      background-color #ffb900

    // 0-79%：蓝色（默认，已在 .capacity-bar-fill-windows 中设置）

  .device-actions
    justify-content flex-end
    margin-top 4px
    gap 5px

    .btn
      padding 4px 10px
      font-size 9px
      min-height 20px
      line-height 1.3

  // 托盘窗口中的设备操作按钮
  .device-actions-tray
    display flex
    justify-content flex-end
    margin-top 6px
    gap 4px
    flex-wrap wrap

    .btn
      padding 5px 12px
      font-size 10px
      min-height 24px
      line-height 1.3
      white-space nowrap

  .empty-state
    padding 30px 12px

    .empty-icon
      width 40px
      height 40px
      margin-bottom 10px

      &::before
        width 24px
        height 24px

    p
      font-size 11px
      margin 5px 0

    .empty-hint
      font-size 9px
      margin-top 3px

// 设备容器（统一布局）
.devices-container
  display flex
  flex-direction column
  flex 1
  min-height 0
  padding 16px 20px
  overflow-y auto
  overflow-x hidden

  // 滚动条样式
  &::-webkit-scrollbar
    width 6px

  &::-webkit-scrollbar-track
    background transparent

  &::-webkit-scrollbar-thumb
    background var(--border)
    border-radius 3px

    &:hover
      background var(--accent)

  // 标题区域
  .section-header
    display flex
    justify-content space-between
    align-items center
    margin-bottom 12px
    flex-shrink 0

    h2
      font-size 15px
      font-weight 500
      color var(--text-primary)
      letter-spacing -0.01em
      margin 0

    .header-actions
      display flex
      flex-direction column
      gap 8px
      align-items flex-end

      .header-actions-row
        display flex
        gap 8px
        align-items center
        flex-wrap wrap
        justify-content flex-end

      .auto-mount-checkbox
        display flex
        align-items center
        gap 6px
        font-size 13px
        color var(--text-primary)
        cursor pointer
        user-select none
        padding 4px 8px
        border-radius 4px
        transition background-color 0.15s ease

        &:hover
          background var(--bg-tertiary)

        input[type="checkbox"]
          width 16px
          height 16px
          cursor pointer
          accent-color var(--accent)

        span
          font-weight 500
          letter-spacing -0.01em

      .btn
        display inline-flex
        align-items center
        justify-content center
        white-space nowrap

        .btn-icon
          width 12px
          height 12px
          display block
          margin 0
          padding 0
          flex-shrink 0

      #refreshDevicesBtn
        padding 6px 12px
        min-width auto
        width auto

// 设备列表容器
.devices-list
  display flex
  flex-direction column
  gap 8px
  flex-shrink 0

// 设备项样式（macOS 风格）
.device-item
  background var(--bg-secondary)
  border 1px solid var(--border)
  border-radius 8px
  padding 12px 16px
  transition all 0.2s cubic-bezier(0.4, 0, 0.2, 1)
  position relative
  overflow hidden
  opacity 1
  transform translateZ(0)
  will-change auto

  // 悬停效果
  &:hover
    background var(--bg-tertiary)
    border-color var(--border)
    box-shadow 0 1px 2px var(--shadow)

  // 左侧装饰条
  &::before
    content ''
    position absolute
    left 0
    top 0
    bottom 0
    width 3px
    background var(--border)
    transition all 0.15s cubic-bezier(0.4, 0, 0.2, 1)

  // 只读设备
  &.read-only::before
    background var(--warning)

  // 读写设备
  &.read-write::before
    background var(--success)

  // 已卸载设备
  &.unmounted-device::before
    background var(--text-secondary)

// 设备头部
.device-header
  display flex
  justify-content space-between
  align-items center
  margin-bottom 10px

.device-name
  display flex
  align-items center
  gap 8px
  font-size 13px
  font-weight 500
  color var(--text-primary)
  letter-spacing -0.01em

  .device-icon
    width 24px
    height 24px
    display flex
    align-items center
    justify-content center
    background var(--bg-tertiary)
    border-radius 5px
    flex-shrink 0

    // 使用 SVG 图标
    &::before
      content ''
      width 18px
      height 18px
      background-image url('src/imgs/svg/flash-drive.svg')
      background-size contain
      background-repeat no-repeat
      background-position center
      opacity 0.7

// 设备状态标签（macOS 风格）
.device-status
  display inline-flex
  align-items center
  gap 4px
  padding 3px 10px
  border-radius 5px
  font-size 11px
  font-weight 500
  transition all 0.15s cubic-bezier(0.4, 0, 0.2, 1)
  letter-spacing 0.01em

  // 只读状态
  &.read-only
    background rgba(255, 149, 0, 0.15)
    color var(--warning)
    border 1px solid rgba(255, 149, 0, 0.3)

  // 读写状态
  &.read-write
    background rgba(52, 199, 89, 0.15)
    color var(--success)
    border 1px solid rgba(52, 199, 89, 0.3)

    &::before
      content ''
      width 10px
      height 10px
      background-image url('src/imgs/svg/check.svg')
      background-size contain
      background-repeat no-repeat
      background-position center
      filter brightness(0) saturate(100%) invert(60%) sepia(90%) saturate(400%) hue-rotate(120deg) brightness(95%) contrast(90%)

  // 已卸载状态
  &.unmounted
    background rgba(142, 142, 147, 0.15)
    color var(--text-secondary)
    border 1px solid rgba(142, 142, 147, 0.3)

// 设备信息
.device-info
  display flex
  flex-direction column
  gap 6px
  margin-bottom 10px
  padding 8px 12px
  background var(--bg-tertiary)
  border-radius 6px
  border 1px solid var(--border)

.device-info-item
  display flex
  align-items center
  gap 8px
  font-size 12px
  color var(--text-secondary)

  .device-info-label
    font-weight 500
    color var(--text-primary)
    min-width 60px
    flex-shrink 0

  span:not(.device-info-label)
    color var(--text-secondary)
    font-family 'SF Mono', 'Monaco', 'Menlo', 'Courier New', monospace
    font-size 11px
    word-break break-all

// 设备操作按钮
.device-actions
  display flex
  gap 8px
  flex-wrap wrap
  justify-content flex-end

  .mount-btn,
  .unmount-btn
    flex 0 0 auto
    padding 6px 16px
    font-size 12px
    font-weight 500
    border-radius 5px
    transition all 0.15s cubic-bezier(0.4, 0, 0.2, 1)
    position relative
    overflow hidden
    letter-spacing -0.01em
    white-space nowrap

    // 点击效果
    &:active
      transform scale(0.98)

// 空状态（macOS 风格）
.empty-state
  text-align center
  padding 60px 20px
  color var(--text-secondary)
  flex 1
  display flex
  flex-direction column
  justify-content center
  align-items center

  .empty-icon
    width 64px
    height 64px
    margin 0 auto 20px
    display flex
    align-items center
    justify-content center
    background var(--bg-tertiary)
    border-radius 50%
    opacity 0.5
    border 2px dashed var(--border)
    transition all 0.15s cubic-bezier(0.4, 0, 0.2, 1)

    // 使用 SVG 图标
    &::before
      content ''
      width 36px
      height 36px
      background-image url('src/imgs/svg/flash-drive.svg')
      background-size contain
      background-repeat no-repeat
      background-position center
      filter grayscale(1) opacity(0.4)

  p
    font-size 15px
    margin 8px 0
    color var(--text-primary)
    font-weight 500
    letter-spacing -0.01em

  .empty-hint
    font-size 13px
    color var(--text-secondary)
    margin-top 6px

// 已可读写设备列表的特殊样式（现在整合到统一列表中）
.device-item.read-write-device
  border-color var(--success)
  background rgba(52, 199, 89, 0.05)

  &:hover
    background rgba(52, 199, 89, 0.08)
    border-color var(--success)

// 浅色模式调整
body.light-theme
  .device-item
    &:hover
      box-shadow 0 1px 2px var(--light-shadow)

  .device-info
    background var(--light-bg-tertiary)

  .empty-state
    .empty-icon
      background var(--light-bg-tertiary)
      border-color var(--light-border)
